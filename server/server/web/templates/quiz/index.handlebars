<div class="container-fluid h-100">
  <div class="row h-100">
    {{>dashboardNav}}
    <div class="col-sm-9 col-md-10">
      <div style="padding: 30px">
        {{#if quizCompleted}}
          <h2 style="text-align: center;">
            You got {{score}} out of {{questions.length}}.
            {{#if passed}}
              <span class="badge badge-pill badge-success ml-2">{{precentage}}%</span>
            {{else}}
              <span class="badge badge-pill badge-danger ml-2">{{precentage}}%</span>
            {{/if}}
          </h2>
          <br>
          {{#if passed }}
            {{#if certificateEligible}}            
              <h3>Congratulations {{user.firstname}}, You have passed the quiz for this training module.</h3> 
              <h3>Since you have now passed the quizzes for all three modules successfully, you can now receive your certificate of completion.</h3>
              <br>
            {{else}}            
              <h3>Congratulations {{user.name}}, You have passed the quiz for this training module. Please proceed to <a href="../training-module/{{nextModuleId}}">training module {{nextModuleId}}</a>.</h3>
              <br>
            {{/if}}            
          {{else}}
            <h3>You must get at least 80% of questions correct to pass the quiz for this training module.</h3>          
            <h3>Please retake the <a href="#" onclick="retake('{{user._id}}','{{moduleId}}')">quiz for training module {{moduleId}}.</a></h3>
          {{/if}}
          <div class="row">
            <div class="col">              
              <button type="button" class="btn btn-info" data-toggle="collapse" data-target="#details">View your score details</button>             
              {{#if certificateEligible}}              
                <button type="button" class="btn btn-info" onclick="downloadCertificate('{{user.firstname}}', '{{user.lastname}}')">Download certificate of completion.</button>              
              {{/if}}       
            </div>           
          </div>
          <div id="details" class="collapse">                
            {{#each questions as |q|}}
              <div class="card" id={{q.id}} style="margin-bottom:10px;">
                <div class="card-body">
                  <h4>{{q.id}}.{{q.text}}</h4>
                  <br>
                  {{#each q.choices as |choice|}}                  
                    <div class="form-check" style="margin-left:20px;">
                      <input type="checkbox" class="form=check-input" disabled {{checkRadioBtn @index q.answer}}>                                        
                      <label class='{{radioBtnClass ../../passed @index q.answer q.keyIndex}}'>{{choice}}</label>
                    </div>
                  {{/each}}
                </div>
              </div>                      
            {{/each}}
          </div>
        {{else}}       
          <h3>Quiz</h3>        
          {{#each questions as |q|}}
            <div class="card" id={{q.id}} style="margin-bottom:10px;">
              <div class="card-body">
                <h4>{{q.id}}.{{q.text}}</h4>
                <br>
                {{#each q.choices as |choice|}}                  
                  <div class="form-check" style="margin-left:20px;">
                    <input type="radio" class="form-check-input" name={{q.id}} onchange="updateAnswer({{q.id}}, {{@index}}, {{../../moduleId}})" {{checkRadioBtn @index q.answer}}>
                    <label class="form-check-label">{{choice}}</label>
                  </div>
                {{/each}}
              </div>
            </div>                      
          {{/each}}
          <div class="row">
            <div class="col">
              <button class="btn btn-primary" onclick="submit('{{user._id}}', '{{moduleId}}')" {{#if submitBtnDisabled}} disabled {{/if}} id="submit">Submit and see your test results</button>
            </div>          
          </div>
        {{/if}}        
      </div>
    </div>
  </div>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.69/pdfmake.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/pdfmake/0.1.69/vfs_fonts.js"></script>
<script type="text/javascript" src="/public/scripts/quiz.js"></script>

<style>
.wrong {  
  text-decoration: line-through;
  text-decoration-color: red;  
}

.right {  
  text-decoration: underline;
  text-decoration-color: green;    
}
</style>